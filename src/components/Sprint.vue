<template>
	<v-layout>
		<v-flex xs12 sm10 offset-sm1 >
			<v-card>
		        <v-toolbar class="blue-grey darken-3" dark>
					<!-- add method -->	
					<v-dialog v-model="addButton" persistent max-width="500px"> 
				      <v-btn icon dark slot="activator"> <v-icon color="yellow">add</v-icon></v-btn>
				      <v-card>
				        <v-card-title>
				          <span class="headline">Adicionar Sprint</span>
				        </v-card-title>
				        <v-card-text>
				          <v-container grid-list-md>
				            <v-layout wrap>
				              <v-flex xs12 sm6 md4>
				                <v-text-field label="Legal first name" required></v-text-field>
				              </v-flex>
				              <v-flex xs12 sm6 md4>
				                <v-text-field label="Legal middle name" hint="example of helper text only on focus"></v-text-field>
				              </v-flex>
				              <v-flex xs12 sm6 md4>
				                <v-text-field label="Legal last name" hint="example of persistent helper text"
				                  persistent-hint
				                  required
				                ></v-text-field>
				              </v-flex>
				              <v-flex xs12>
				                <v-text-field label="Email" required></v-text-field>
				              </v-flex>
				              <v-flex xs12>
				                <v-text-field label="Password" type="password" required></v-text-field>
				              </v-flex>
				              <v-flex xs12 sm6>
				                <v-select
				                  label="Age"
				                  required
				                  :items="['0-17', '18-29', '30-54', '54+']"
				                ></v-select>
				              </v-flex>
				              <v-flex xs12 sm6>
				                <v-select
				                  label="Interests"
				                  multiple
				                  autocomplete
				                  chips
				                  :items="['Skiing', 'Ice hockey', 'Soccer', 'Basketball', 'Hockey', 'Reading', 'Writing', 'Coding', 'Basejump']"
				                ></v-select>
				              </v-flex>
				            </v-layout>
				          </v-container>
				          <small>*indicates required field</small>
				        </v-card-text>
				        <v-card-actions>
				          <v-spacer></v-spacer>
				          <v-btn color="red darken-1" flat @click.native="addButton = false">Cancelar</v-btn>
				          <v-btn color="blue darken-1" flat @click.native="">Adicionar</v-btn>
				        </v-card-actions>
				      </v-card>
				    </v-dialog>
				    <!-- ending add method -->

		          <v-spacer></v-spacer>
		          <v-text-field label="Pesquisar..."  class="yellow--text mt-3" single-line  append-icon="search"  dark ></v-text-field>
		        </v-toolbar>
				<v-expansion-panel expand>
					<v-expansion-panel-content v-for="(sprint, index) in sprintsList" :key="index" avatar @click="">
				  		<div slot="header">
							<v-btn icon @click.native="editItem(sprint)"><v-icon dark color="yellow lighten-3">edit</v-icon></v-btn>
			                <v-btn icon @click.native="removeItem(sprint)"><v-icon dark color="red lighten-2">delete</v-icon></v-btn>	
				  		{{sprint.code}}
				  		</div>
				  			<v-card color="blue-grey lighten-1">
								 <v-container grid-list-md>
								        <v-layout row wrap>
								          <v-flex xs6>
								            <v-text-field v-if="sprint.responsible" class="input-group--focused" disabled box dark label="Responsável" :value="nameById(sprint.responsible, usersList)"></v-text-field>
								            <v-text-field v-else class="input-group--focused" disabled box dark label="Responsável" value="Não informado"></v-text-field>
								          </v-flex>
								          <v-flex xs6>
								            <v-text-field v-if="sprint.project" class="input-group--focused" disabled box dark label="Projeto" :value="nameById(sprint.project, projectsList)"></v-text-field>
								            <v-text-field v-else class="input-group--focused" disabled box dark label="Projeto" value="Não informado"></v-text-field>
								          </v-flex>
								          <v-flex xs6>
								            <v-text-field box v-if="sprint.impediments > 0" class="input-group--focused" multi-line label="Impedimentos" disabled v-model="sprint.impediments"></v-text-field>
								            <v-text-field v-else box class="input-group--focused" multi-line label="Impedimentos" disabled value="Não informado"></v-text-field>
								          </v-flex>
								          <v-flex xs6>
								            <v-text-field box v-if="sprint.tasks > 0" class="input-group--focused" multi-line label="Tarefas" disabled v-model="sprint.tasks"></v-text-field>
								            <v-text-field v-else box class="input-group--focused" multi-line label="Tarefas" disabled value="Não informado"></v-text-field>
								          </v-flex>
								          <v-flex xs12 sm5 offset-sm1>
							                <v-text-field v-if="sprint.start" class="input-group--focused"
							                  single-line :value="reverseDate(sprint.start)"
							                  append-icon="event" disabled> 
							                </v-text-field>
							              </v-flex>
							              <v-flex xs12 sm5>
							                <v-text-field v-if="sprint.end"
							                  single-line :value="reverseDate(sprint.end)"
							                  append-icon="event_available" disabled> 
							                </v-text-field>
							                <v-text-field v-else
							                  single-line :value="sprint.end"
							                  append-icon="event_busy" disabled> 
							                </v-text-field>
							              </v-flex>
								        </v-layout>
								      </v-container>
				  			</v-card>
					</v-expansion-panel-content>
				</v-expansion-panel>
	        </v-card>
		</v-flex>
	</v-layout>
</template>

<script>
import axios from 'axios';
import store from '@/core';
import { mapGetters } from 'vuex';

export default {
  data () {
    return {
     addButton: false
    }
  },

  methods:{
  	nameById (url, list) {
  		let nome = '';
  		let id = url.split('/').reverse()[1];
  		list.map( user => user.id == id ? nome = user.name : null);
  		return nome;
  	},
  	reverseDate (date) {
  		return date.split('-').reverse().join('/');
  	}
  },

  computed:{
  	...mapGetters({
  		sprintsList:'getSprintsList',
  		usersList: 'getUsersList',
  		projectsList: 'getProjectsList',
  		tasksList: 'getTasksList'
  	})
  },

  created(){

  }
}
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>

.input-group--focused{
	color:#FFD700 !important;
}

</style>